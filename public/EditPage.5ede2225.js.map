{"mappings":"wZAAA,IAAAA,EAAAC,EAAA,8HAWA,MAAMC,EAAmB,CACvBC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,GAAI,GACJC,EAAG,GACHC,GAAI,GACJC,GAAI,IAgBAC,EAED,EApCLC,SAoCQA,MACN,MAAMC,EAAoB,CACxBC,KAAI,IACKX,GAGX,OAAOF,EAAAc,IAACC,EAAAC,QAAQ,CAACC,KAAML,EAAmBD,SAAUA,SA8BtDO,EA3BmD,EA7CnDC,SA6CsDA,MACpD,MAAMC,EAAWC,EAAAC,eACfH,EAAWI,EAAAC,SAASC,KAAKC,MAAO,QAAKC,GAEjCC,EAAcL,EAAAM,OAAOT,EAAU,UAC/BH,EAAOa,EAAAC,WAAWX,EAASY,UAC3BrB,EA9Bc,EAACS,EAAkBa,EAAuB,OAC9D,MAAMC,EAAWC,EAAAC,cASjB,OARiBC,MACfC,EACAC,WAEMT,EAAAU,MAAMC,IAAI,CAAEC,IAAKtB,KAAamB,KAAQD,IAC5CK,QAAQC,IAAI,CA5BhBX,aA4BkBA,IACdC,EAASD,KAsBMY,CACfzB,EAASY,SACTb,EAAW,WAAa,KAG1B,OACEnB,EAAA8C,KAACC,EAAAC,IAAG,CAACC,GAAE,OAAQC,SAAQ,QAASC,EAAC,cAC/BnD,EAAA8C,KAACC,EAAAK,QAAO,CAACC,GAAE,IAAKC,GAAE,oCACI1B,KAEtB5B,EAAAc,IAACyC,EAAAvC,QAAqB,CAACwC,SAAUxD,EAAAc,IAACJ,EAAY,CAACC,SAAUA,IA7D/D8C,SA8DQzD,EAAAc,IAAC4C,EAAA1C,QAAoB,CA9D7ByC,SA+DUzD,EAAAc,IAAC6C,EAAAC,SAAQ,CAACJ,SAAUxD,EAAAc,IAACiC,EAAAc,QAAO,CAACC,KAAI,OA/D3CL,SAgEYzD,EAAAc,IAACC,EAAAC,QAAQ,CAACC,KAAMA,EAAMN,SAAUA,kFChE5C,IAAAX,EAAAC,EAAA,yFAOA,MAAM8D,EAAaC,EAAAC,OACjBnC,EAAAoC,KAAKC,QACH,CAACC,EAAQC,KAAS,IACbD,EACHC,CAACA,GAAML,EAAAM,SAAaC,SAAS,0BAA0BC,IAAI,QAE7D,SAqCJC,EA9BK,EApBLxD,KAoBQA,EApBRN,SAoBcA,MACZ,MAAM4B,EAAMtB,EAAKJ,OAEjB,OACEb,EAAAc,IAAC4D,EAAAC,OAAM,CACLC,cAAerC,EACfsC,oBAAkB,EAClBlE,SAAW2B,GAAW3B,EAAS2B,EAAQC,GACvCuC,iBAAkBf,EA5BxBN,SA8BMzD,EAAAc,IAAC4D,EAAAK,KAAI,CA9BXtB,SA+BQzD,EAAA8C,KAACC,EAAAiC,WAAU,CAACC,SAAQ,cACjBnD,EAAAoC,KAAKgB,KAAKb,GACTrE,EAAAc,IAACqE,EAAAnE,QAAU,CAAWoE,KAAMf,EAAKf,GAAE,KAAlBe,KAEnBrE,EAAAc,IAACiC,EAAAsC,OAAM,CACLC,KAAI,SACJC,YAAW,OACXC,MAAK,OACLtC,SAAU,CAAC,KAAM,SACjBI,GAAE,IAxCdG,SAAA","sources":["src/components/EditPage.tsx","src/components/MenuForm.tsx"],"sourcesContent":["import React, { Suspense } from \"react\";\nimport { Box, Heading, Spinner } from \"@chakra-ui/react\";\nimport { format, addWeeks } from \"date-fns\";\nimport { useNavigate } from \"react-router\";\nimport { local, useQueryDB, Menu, MenuResource } from \"../db\";\nimport { getMenuDateFor } from \"../utils\";\nimport SessionErrorBoundary from \"./SessionErrorBoundary\";\nimport NotFoundErrorBoundary from \"./NotFoundErrorBoundary\";\nimport NavBar from \"./NavBar\";\nimport MenuForm from \"./MenuForm\";\n\nconst BLANK_MENU: Menu = {\n  M: \"\",\n  T: \"\",\n  W: \"\",\n  Th: \"\",\n  F: \"\",\n  Sa: \"\",\n  Su: \"\",\n};\n\nconst useMenuUpdate = (menuDate: string, returnToPath: string = \"/\") => {\n  const navigate = useNavigate();\n  const onSubmit = async (\n    values: Menu,\n    doc: ReturnType<MenuResource[\"read\"]>\n  ) => {\n    await local.put({ _id: menuDate, ...doc, ...values });\n    console.log({ returnToPath });\n    navigate(returnToPath);\n  };\n  return onSubmit;\n};\n\nconst FallbackForm: React.FC<{\n  onSubmit: ReturnType<typeof useMenuUpdate>;\n}> = ({ onSubmit }) => {\n  const blankMenuResource = {\n    read() {\n      return BLANK_MENU as ReturnType<MenuResource[\"read\"]>;\n    },\n  };\n  return <MenuForm menu={blankMenuResource} onSubmit={onSubmit} />;\n};\n\nconst EditPage: React.FC<{ planning?: boolean }> = ({ planning }) => {\n  const menuDate = getMenuDateFor(\n    planning ? addWeeks(Date.now(), 1) : undefined\n  );\n  const currentWeek = format(menuDate, \"MMM do\");\n  const menu = useQueryDB(menuDate.toJSON());\n  const onSubmit = useMenuUpdate(\n    menuDate.toJSON(),\n    planning ? \"/preview\" : \"/\"\n  );\n\n  return (\n    <Box mx=\"auto\" maxWidth=\"500px\" p=\"3\">\n      <Heading mt=\"0\" mb=\"4\">\n        Edit Weekly Menu - {currentWeek}\n      </Heading>\n      <NotFoundErrorBoundary fallback={<FallbackForm onSubmit={onSubmit} />}>\n        <SessionErrorBoundary>\n          <Suspense fallback={<Spinner size=\"lg\" />}>\n            <MenuForm menu={menu} onSubmit={onSubmit} />\n          </Suspense>\n        </SessionErrorBoundary>\n      </NotFoundErrorBoundary>\n    </Box>\n  );\n};\n\nexport default EditPage;\n","import React from \"react\";\nimport { Button, SimpleGrid } from \"@chakra-ui/react\";\nimport { Formik, Form } from \"formik\";\nimport * as Yup from \"yup\";\nimport { Menu, MenuResource, DAYS } from \"../db\";\nimport InputGroup from \"./InputGroup\";\n\nconst FormSchema = Yup.object(\n  DAYS.reduce(\n    (result, day) => ({\n      ...result,\n      [day]: Yup.string().required(\"This field is required\").max(100),\n    }),\n    {}\n  )\n);\n\nconst MenuForm: React.FC<{\n  menu: MenuResource;\n  onSubmit: (values: Menu, doc: ReturnType<MenuResource[\"read\"]>) => void;\n}> = ({ menu, onSubmit }) => {\n  const doc = menu.read();\n\n  return (\n    <Formik\n      initialValues={doc}\n      enableReinitialize\n      onSubmit={(values) => onSubmit(values, doc)}\n      validationSchema={FormSchema}\n    >\n      <Form>\n        <SimpleGrid spacingY=\"3\">\n          {DAYS.map((day) => (\n            <InputGroup key={day} name={day} mb=\"2\" />\n          ))}\n          <Button\n            type=\"submit\"\n            colorScheme=\"pink\"\n            width=\"100%\"\n            maxWidth={[null, \"10rem\"]}\n            mb=\"3\"\n          >\n            Save\n          </Button>\n        </SimpleGrid>\n      </Form>\n    </Formik>\n  );\n};\n\nexport default MenuForm;\n"],"names":["$k4ank","parcelRequire","$016a7f68f397bea3$var$BLANK_MENU","M","T","W","Th","F","Sa","Su","$016a7f68f397bea3$var$FallbackForm","onSubmit","blankMenuResource","read","jsx","$6bwyZ","default","menu","$016a7f68f397bea3$export$2e2bcd8739ae039","planning","menuDate","$8Xs7T","getMenuDateFor","$80TUu","addWeeks","Date","now","undefined","currentWeek","format","$fiQoM","useQueryDB","toJSON","returnToPath","navigate","$aR93f","useNavigate","async","values","doc","local","put","_id","console","log","$016a7f68f397bea3$var$useMenuUpdate","jsxs","$37woU","Box","mx","maxWidth","p","Heading","mt","mb","$hmWjK","fallback","children","$1k9WB","$8T3gX","Suspense","Spinner","size","$20eb6da75de2e27f$var$FormSchema","$aNkVi","object","DAYS","reduce","result","day","string","required","max","$20eb6da75de2e27f$export$2e2bcd8739ae039","$g2LMr","Formik","initialValues","enableReinitialize","validationSchema","Form","SimpleGrid","spacingY","map","$1xLD5","name","Button","type","colorScheme","width"],"version":3,"file":"EditPage.5ede2225.js.map"}